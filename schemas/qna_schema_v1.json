{
  "$id": "https://harbourmaster.ai/schemas/qna_schema_v1.json",
  "title": "Harbourmaster Q&A (MVP, single-table)",
  "description": "Schema for harbour_questions table with GPT-o1-pro optimizations",
  "type": "object",
  "required": ["harbour", "question", "answer", "category", "tags", "tier"],
  "additionalProperties": false,
  "properties": {
    "harbour": {
      "type": "string",
      "minLength": 2,
      "maxLength": 100,
      "description": "Harbour name (e.g., 'Kioni', 'Vathi')"
    },
    "question": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "User-facing question"
    },
    "answer": {
      "type": "string",
      "minLength": 10,
      "maxLength": 2000,
      "description": "Detailed answer. Pro/Exclusive tier MUST have numbered steps."
    },
    "category": {
      "type": "string",
      "enum": [
        "Mooring",
        "Anchoring",
        "Facilities & Services",
        "Navigation & Approach",
        "Weather & Conditions",
        "Safety & Regulations",
        "Provisioning & Supplies",
        "Local Knowledge",
        "Emergency & Support"
      ],
      "description": "Exactly one of the 9 primary categories (case-sensitive)"
    },
    "tags": {
      "type": "array",
      "minItems": 1,
      "maxItems": 10,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "pattern": "^[a-z_]+:[a-z0-9_]+$",
        "description": "Domain-prefixed tags (e.g., 'mooring:stern_to', 'anchor:depth_3_6m')"
      },
      "description": "Tags with domain prefix (domain:value format)"
    },
    "tier": {
      "type": "string",
      "enum": ["free", "pro", "exclusive"],
      "description": "Content tier (lowercase only)"
    },
    "notes": {
      "type": ["string", "null"],
      "maxLength": 500,
      "description": "Optional internal notes"
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "tier": {
            "enum": ["pro", "exclusive"]
          }
        }
      },
      "then": {
        "properties": {
          "answer": {
            "type": "string",
            "pattern": "\\d+\\.\\s",
            "description": "Pro/Exclusive tier requires numbered steps (1. 2. 3. etc.)"
          }
        }
      }
    }
  ]
}
